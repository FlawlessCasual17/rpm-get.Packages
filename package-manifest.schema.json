{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Package Manifest Schema",
  "description": "Schema for package manifest file",
  "type": "object",
  "required": [
    "version",
    "name",
    "description",
    "homepage",
    "notes",
    "arch",
    "auto_update"
  ],
  "properties": {
    "version": {
      "type": "string",
      "description": "Package version"
    },
    "name": {
      "type": "string",
      "description": "Package name"
    },
    "homepage": {
      "type": "string",
      "description": "Package homepage"
    },
    "description": {
      "type": "string",
      "description": "Package description"
    },
    "notes": {
      "type": "string",
      "description": "Additional notes about the package"
    },
    "arch": {
      "type": "object",
      "description": "Architecture-specific download information",
      "properties": {
        "x86_64": {
          "type": "object",
          "description": "x86_64 architecture (also works for amd64/64bit)",
          "properties": {
            "url": {
              "type": "string",
              "description": "Download URL for x86_64 architecture"
            },
            "hash": {
              "type": "string",
              "description": "Download hash for x86_64 architecture"
            }
          },
          "required": ["url", "hash"]
        },
        "x86": {
          "type": "object",
          "description": "x86 architecture (also works for i386/32bit)",
          "properties": {
            "url": {
              "type": "string",
              "description": "Download URL for x86 architecture"
            },
            "hash": {
              "type": "string",
              "description": "Download hash for x86 architecture"
            }
          },
          "required": ["url", "hash"]
        },
        "arm64": {
          "type": "object",
          "description": "arm64 architecture",
          "properties": {
            "url": {
              "type": "string",
              "description": "Download URL for arm64 architecture"
            },
            "hash": {
              "type": "string",
              "description": "Download hash for arm64 architecture"
            }
          },
          "required": ["url", "hash"]
        },
        "aarch64": {
          "type": "object",
          "description": "aarch64 architecture",
          "properties": {
            "url": {
              "type": "string",
              "description": "Download URL for aarch64 architecture"
            },
            "hash": {
              "type": "string",
              "description": "Download hash for aarch64 architecture"
            }
          },
          "required": ["url", "hash"]
        }
      }
    },
    "repo": {
      "type": "object",
      "description": "Information about an RPM repository (Will eventually support Zypper repos)",
      "properties": {
        "url": {
          "type": "string",
          "description": "Package repository URL"
        },
        "gpg_key_url": {
          "type": "string",
          "description": "Repository GPG key URL"
        }
      },
      "required": ["url"]
    },
    "github": {
      "anyOf": [
        {
          "type": "string",
          "description": "Information about a GitHub repository. This must be in the format 'username/repository-name'",
          "pattern": "^[a-zA-Z0-9_-]+/[a-zA-Z0-9_-]+$"
        },
        {
          "type": "object",
          "description": "Information about a GitHub repository",
          "properties": {
            "owner": {
              "type": "string",
              "description": "Can either be a GitHub username or organization name"
            },
            "repo": {
              "type": "string",
              "description": "GitHub repository name"
            }
          },
          "required": ["creator", "repo"]
        }
      ]
    },
    "gitlab": {
      "anyOf": [
        {
          "type": "string",
          "description": "Information about a GitLab repository. This must be in the format 'group/sub-group/project'",
          "pattern": "^[a-zA-Z0-9_-]+/[a-zA-Z0-9_-]+/[a-zA-Z0-9_-]+$"
        },
        {
          "type": "string",
          "description": "Information about a GitLab repository. This must be in the format 'owner/project'",
          "pattern": "^[a-zA-Z0-9_-]+/[a-zA-Z0-9_-]+$"
        },
        {
          "type": "object",
          "description": "Information about a GitLab repository",
          "properties": {
            "group": {
              "type": "string",
              "description": "GitLab group name"
            },
            "sub_group": {
              "type": "string",
              "description": "GitLab sub-group name"
            },
            "project": {
              "type": "string",
              "description": "GitLab project name"
            }
          }
        },
        {
          "type": "object",
          "description": "Information about a GitLab repository",
          "properties": {
            "group": {
              "type": "string",
              "description": "GitLab group name"
            },
            "project": {
              "type": "string",
              "description": "GitLab project name"
            }
          }
        },
        {
          "type": "object",
          "description": "Information about a GitLab repository",
          "properties": {
            "profile": {
              "type": "string",
              "description": "GitLab profile name"
            },
            "project": {
              "type": "string",
              "description": "GitLab project name"
            }
          }
        }
      ]
    },
    "copr": {
      "type": "object",
      "description": "Information about a Fedora COPR repository",
      "properties": {
        "user": {
          "type": "string",
          "description": "Copr user name"
        },
        "project": {
          "type": "string",
          "description": "Copr project name"
        }
      },
      "required": ["user", "project"]
    },
    "depends": {
      "type": "array",
      "description": "List of package dependencies",
      "items": {
        "type": "string"
      }
    },
    "recommends": {
      "type": "array",
      "description": "List of recommended packages",
      "items": {
        "type": "string"
      }
    },
    "suggests": {
      "type": "array",
      "description": "List of suggested packages",
      "items": {
        "type": "string"
      }
    },
    "conflicts": {
      "type": "array",
      "description": "List of conflicting packages",
      "items": {
        "type": "string"
      }
    },
    "replaces": {
      "type": "array",
      "description": "List of packages that this package replaces",
      "items": {
        "type": "string"
      }
    },
    "provides": {
      "type": "array",
      "description": "List of features this package provides",
      "items": {
        "type": "string"
      }
    },
    "auto_update": {
      "type": "object",
      "description": "Auto-update configuration",
      "required": ["check_version", "url", "hash"],
      "properties": {
        "check_version": {
          "type": "object",
          "description": "Configuration for checking package version",
          "required": ["url", "regex"],
          "properties": {
            "url": {
              "type": "string",
              "description": "URL to check for new versions"
            },
            "regex": {
              "type": "string",
              "description": "Regular expression to extract version information"
            }
          }
        },
        "url": {
          "type": "string",
          "description": "Download URL for auto-updates"
        },
        "hash": {
          "type": "string",
          "description": "Download hash for auto-updates"
        },
        "arch": {
          "type": "object",
          "description": "Architecture-specific auto-update information",
          "properties": {
            "x86_64": {
              "type": "object",
              "description": "x86_64 architecture (also works for amd64/64bit)",
              "properties": {
                "url": {
                  "type": "string",
                  "description": "Auto-update URL for x86_64 architecture"
                },
                "hash": {
                  "type": "string",
                  "description": "Auto-update hash for x86_64 architecture"
                }
              },
              "required": ["url", "hash"]
            },
            "x86": {
              "type": "object",
              "description": "x86 architecture (also works for i386/32bit)",
              "properties": {
                "url": {
                  "type": "string",
                  "description": "Auto-update URL for x86 architecture"
                },
                "hash": {
                  "type": "string",
                  "description": "Auto-update hash for x86 architecture"
                }
              },
              "required": ["url", "hash"]
            },
            "arm64": {
              "type": "object",
              "description": "arm64 architecture",
              "properties": {
                "url": {
                  "type": "string",
                  "description": "Auto-update URL for arm64 architecture"
                },
                "hash": {
                  "type": "string",
                  "description": "Auto-update hash for arm64 architecture"
                }
              },
              "required": ["url", "hash"]
            },
            "aarch64": {
              "type": "object",
              "description": "aarch64 architecture",
              "properties": {
                "url": {
                  "type": "string",
                  "description": "Auto-update URL for aarch64 architecture"
                },
                "hash": {
                  "type": "string",
                  "description": "Auto-update hash for aarch64 architecture"
                }
              },
              "required": ["url", "hash"]
            }
          }
        }
      }
    }
  }
}
